<html>
<head>
<title>Monutor user guide</title>

    <link rel="shortcut icon"
     href="monutor.ico">
    <style> 

    body,textarea,input
    {
      background-color: #111; 
      color: #0f0; 
      font-family: monospace; 
    }

    table
    {
      background-color: #111; 
      width: 100%; 
      border: 1px solid blue; 

    } 

    hr
    {
      color: green; 

    }
    p,h1,h2
    {
      color: #0f0; 
    }

    a
    {
      color: #1f1; 

    }
 
    </style>
</head>
<body>

    <h1> Monutor User Guide</h1> 

    <hr> 
    <h2> Introduction</h2> 

    <p>Monutor is the monitoring tool for phased array data. Right now it consists of three panels: <a href="#hk">hk</a>, <a href="#status">status</a> and <a href="#event">event</a> 

    <p>Unlike AWARE, which uses server-side PHP scripts, Monutor is
  statically-generated client-side, using <a
  href="https://root.cern.ch/js/">jsroot</a> to read ROOT files on the server
that contain all of the data. Approximately every two hours, a batch job on the
UChicago cluster checks to see if any new data is available on the UW data
server. If data is available, it is fetched, extracted, and rootified, and the
runlist and update time are updated on monutor. 

<p>One common failure mode is that the batch job may fail to run. This can happen
due to cluster congestion, loss of the job state, or some other technical
reason with the job queue. If this happens, the date displayed on monutor will
be out of date. In that case, contact Cosmin and he can try to fix it or
manually run monutor until the cluster resolves itself. 

<hr>
<a name="hk"\> 
  <h2> HK</h2> 
  <p>Housekeeping data is shown on the HK page. By default the last week is shown, with decimated data every 10 entries. 
  The time range may be modified by entering the start and end times in the right format. The cut can be used to display less decimated data, but beware that showing too much data might make jsroot (or your browser!) choke. The plots should be zoom-inable. If they are not, refresh the page. 

  <p>The default panels shown are temperatures, currents and disk space. Things to check for are the two boards not being too much above 50C ( a few degrees over is fine), the currents not being too crazy ( a few glitches is fine, near run restarts, sometimes the boards are restarted to force better alignment),  and that the disk space is not close to 0. 

  <p>All of the panels on the HK page are actually generated by queries to the ROOT trees using the queries in the text box at the top. If you want, you can add your own plots using the format specified. This is a bit fragile though. If things don't make sense, check the javascript error log. 

  <hr> 
<a name="status"\>
  <h2> Status</h2>
  <p> The status page shows the scalers (which measure how often things trigger) and thresholds. Surface scalers are also available but those no longer do anything. By default, the last 8 runs are shown (1 day) but you can change the runs shown. Also, by default decimated files are shown to avoid plotting too many points. You can add cuts and change the plots displayed just like on the HK page. 

  <p>On the global scalers, the main thing to check is that the rate is about 10 Hz. There are three scalers: fast are 1 second averages, slow are 10 second averages, and slow gated are 10 second averages with a gate near the PPS second. The slow gated should be around 1 Hz if the calpulser is working properly. Sometimes it will be 2 Hz because the calpulser fires twice or something? 

  <p>The beam scalers and thresholds will vary some, especially when the balloon flies over. Some of the thresholds have other behavior, which we believe is related to 137 MHz satellites. 
  <hr> 
  <a name="event"\> 
  <h2> Event</h2> 

  <p> Finally, the event page is an event display. Only a subset of waveforms are available over satellite, although all metadata is sent. You can browse through and make sure the channels are working and the calpulsers appear. You can also look for any strange behavior in the spectra.  There are various options available (averaging spectra, envelopes, IIR filters) that may be documented some day :). Someday, I may port interferometry to monutor from the BEACON equivalent. 

  <p> On the event page you can also download the relevant ROOT files for each run and also a CSV file of the waveforms, in case you want to do that for some reason. 

  <p> Channel Map (as of 2020!): 
  <table>
    <tr> <td>Board</td> <td> Channel</td> <td> Description</td> </tr> 
    <tr> <td> 0 </td> <td> 0 </td> <td> PAV0 (top) </td> </tr> 
    <tr> <td> 0 </td> <td> 1 </td> <td> PAV1  </td> </tr> 
    <tr> <td> 0 </td> <td> 2 </td> <td> PAV2  </td> </tr> j
    <tr> <td> 0 </td> <td> 3 </td> <td> PAV3  </td> </tr> 
    <tr> <td> 0 </td> <td> 4 </td> <td> PAV4 </td> </tr> 
    <tr> <td> 0 </td> <td> 5 </td> <td> ARA VPol  </td> </tr> 
    <tr> <td> 0 </td> <td> 6 </td> <td> PAV5 </td> </tr> 
    <tr> <td> 0 </td> <td> 7 </td> <td> PAV6 </td> </tr> 
    <tr> <td> 1 </td> <td> 0 </td> <td> PAH0 (top) </td> </tr> 
    <tr> <td> 1 </td> <td> 1 </td> <td> PAH1  </td> </tr> 
    <tr> <td> 1 </td> <td> 2 </td> <td> ARA VPol  </td> </tr> 
    <tr> <td> 1 </td> <td> 3 </td> <td> ARA VPol  </td> </tr> 
    <tr> <td> 1 </td> <td> 4 </td> <td> ARA VPol  </td> </tr> 
    <tr> <td> 1 </td> <td> 5 </td> <td> ARA VPol  </td> </tr> 
    <tr> <td> 1 </td> <td> 6 </td> <td> ARA VPol  </td> </tr> 
    <tr> <td> 1 </td> <td> 7 </td> <td> ARA VPol  </td> </tr> 
  </table>


</body> 
</html> 


